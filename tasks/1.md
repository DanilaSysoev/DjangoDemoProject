# Задание 1: «Панель цитат факультета информатики»

## Контекст и тема

Представьте, что вы делаете мини-витрину для сайта факультета информатики. На главной странице должна показываться **одна случайная цитата** из внутренней базы «цитат дня». Редакторы будут добавлять цитаты через админку, а посетители при каждом заходе (или обновлении страницы) видят случайную.

**Требования по ограничениями задания:**

* **Без параметров в URL.**
* **Без фильтрации QuerySet’ов** — используем **только** `Model.objects.all()` (никаких `.filter()`, `.order_by()`, `.first()` и т. п.).
* На главной странице выводится **один случайный объект** вашей модели (или сообщение, что записей нет).
* В `urls` приложения нужно сделать **перенаправление** (например, `/home/ → /`).

---

## Что нужно сделать (высокоуровневый план)

1. Инициализировать Django-проект и создать в нём приложение.
2. Подключить приложение в `settings.py`.
3. Создать простую модель (например, `Quote` с текстом и автором).
4. Применить миграции и добавить несколько записей (через админку или shell).
5. Настроить маршрутизацию: корень сайта (`/`) отдаёт главную, а внутри `urls` приложения есть redirect.
6. Написать вью, которая берёт все объекты через `objects.all()`, выбирает один случайный и отдаёт в шаблон.
7. В шаблоне отобразить цитату; если записей нет — показать понятное сообщение.

---

## Подсказки и примеры (в спойлерах)

<details>
<summary><b>1) Создание проекта и приложения</b></summary>

```bash
python -m venv .venv && source .venv/bin/activate  # Windows: .venv\Scripts\activate
pip install django
django-admin startproject randomshow .
python manage.py startapp catalog
```

</details>

<details>
<summary><b>2) Подключение приложения</b></summary>

Добавьте приложение в `INSTALLED_APPS`:

```python
# randomshow/settings.py
INSTALLED_APPS = [
    # ...
    "catalog",
]
```

</details>

<details>
<summary><b>3) Пример модели (простая «цитата»)</b></summary>

```python
# catalog/models.py
from django.db import models

class Quote(models.Model):
    text = models.CharField(max_length=200)
    author = models.CharField(max_length=100, blank=True)

    def __str__(self):
        return f"{self.text} — {self.author}" if self.author else self.text
```

Миграции:

```bash
python manage.py makemigrations
python manage.py migrate
```

</details>

<details>
<summary><b>4) Добавление данных (админка или shell)</b></summary>

Создание суперпользователя:

```bash
python manage.py createsuperuser
python manage.py runserver
# зайдите на /admin и добавьте несколько Quote
```

ИЛИ через shell:

```bash
python manage.py shell
```

```python
from catalog.models import Quote
Quote.objects.create(text="Talk is cheap. Show me the code.", author="Linus Torvalds")
Quote.objects.create(text="Simple is better than complex.", author="Zen of Python")
exit()
```

</details>

<details>
<summary><b>5) Маршрутизация проекта и приложения + redirect</b></summary>

Подключите urls приложения в корень:

```python
# randomshow/urls.py
from django.contrib import admin
from django.urls import path, include

urlpatterns = [
    path("admin/", admin.site.urls),
    path("", include("catalog.urls")),
]
```

Создайте `catalog/urls.py` с главной и перенаправлением:

```python
# catalog/urls.py
from django.urls import path
from django.views.generic import RedirectView
from . import views

urlpatterns = [
    path("", views.home, name="home"),
    path("home/", RedirectView.as_view(pattern_name="home", permanent=False)),
]
```

</details>

<details>
<summary><b>6) Вью: случайный объект из <code>objects.all()</code></b></summary>

> Важно: не используйте `filter`, `order_by`, `first` и т. п. — только `all()`.

```python
# catalog/views.py
import random
from django.shortcuts import render
from .models import Quote

def home(request):
    qs = Quote.objects.all()  # только all()
    quote = random.choice(list(qs)) if qs.exists() else None
    return render(request, "catalog/home.html", {"quote": quote})
```

</details>

<details>
<summary><b>7) Шаблон главной</b></summary>

Создайте `templates/catalog/home.html` и подтяните его через `DIRS` в `TEMPLATES` при необходимости.

```html
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Цитата дня</title>
  </head>
  <body>
    <h1>Цитата дня</h1>
    {% if quote %}
      <blockquote>
        <p>{{ quote.text }}</p>
        {% if quote.author %}<footer>— {{ quote.author }}</footer>{% endif %}
      </blockquote>
    {% else %}
      <p>Нет записей. Добавьте хотя бы одну цитату и обновите страницу.</p>
    {% endif %}
  </body>
</html>
```

</details>

<details>
<summary><b>8) Запуск и проверка</b></summary>

```bash
python manage.py runserver
# Откройте http://127.0.0.1:8000/ — на главной должен быть случайный объект
# http://127.0.0.1:8000/home/ должно перенаправлять на /
```

Обновляйте страницу и убедитесь, что показываются разные цитаты.

</details>

<details>
<summary><b>9) (Опционально) Автотест на доступность главной</b></summary>

```python
# catalog/tests/test_views.py
import pytest
from django.urls import reverse
from catalog.models import Quote

@pytest.mark.django_db
def test__home__ok_without_records__shows_empty_message(client):
    resp = client.get(reverse("home"))
    assert resp.status_code == 200
    assert b"Нет записей" in resp.content

@pytest.mark.django_db
def test__home__ok_with_records__shows_any_quote(client):
    Quote.objects.create(text="A", author="")
    Quote.objects.create(text="B", author="X")
    resp = client.get(reverse("home"))
    assert resp.status_code == 200
    # проверим, что хотя бы одна из строк попала в ответ
    assert (b"A" in resp.content) or (b"B" in resp.content)
```

</details>

---

## Что сдавать

* Ссылку на репозиторий или архив проекта.
* Короткое **README** с инструкцией запуска.
* Скриншот главной страницы при наличии нескольких записей (2–3 добавьте заранее).

---
