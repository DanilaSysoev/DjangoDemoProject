# Задание: Django-приложение «Гильдии и Квесты»

## Цель

Спроектировать и реализовать Django-приложение про фэнтези-мир с полным набором типов связей:

1. One-to-One
2. One-to-Many
3. Many-to-Many (только `ManyToManyField`, без промежуточной модели)

Подготовить набор **статических** страниц (шаблонов) со **статическими URL** (без параметров), которые наглядно показывают связи между объектами. На каждой такой странице можно выводить списки элементов моделей с их связанными объектами.

---

## Доменные модели и связи

### 1) Игрок и профиль (One-to-One)

* **Player** — игровой персонаж.
  Атрибуты (словами):

  * `username` — строка, уникальное игровое имя.
  * `level` — целое неотрицательное, уровень персонажа.
  * `gold` — целое неотрицательное, количество золота.
  * `created_at` — дата/время создания.

* **PlayerProfile** — расширенные сведения об игроке.
  Атрибуты:

  * `player` — связь One-to-One на `Player`, обязательная и уникальная.
  * `bio` — текст, краткое описание.
  * `avatar_url` — URL, ссылка на аватар.
  * `preferred_role` — строковый выбор (например: warrior, mage, ranger).
  * `birth_date` — дата рождения, необязательное поле.

**Что демонстрирует:** у каждого игрока ровно один профиль, и у профиля — ровно один владелец. Доступ в обе стороны.

---

### 2) Гильдия и её участники (One-to-Many)

* **Guild** — гильдия игроков.
  Атрибуты:

  * `name` — строка, уникальное имя гильдии.
  * `motto` — строка, девиз.
  * `founded_at` — дата основания.

* **Player.guild** — внешний ключ из `Player` на `Guild` (может быть `null`, если игрок без гильдии).
  Это даёт связь «одна гильдия → много игроков». На стороне `Guild` должен быть осмысленный `related_name`, например `members`.

**Что демонстрирует:** один-ко-многим — у гильдии много участников, у игрока максимум одна гильдия.

---

### 3) Квесты и участники (Many-to-Many)

* **Quest** — задание/квест.
  Атрибуты:

  * `code` — строка, уникальный код квеста (например, `DRAGON_HUNT`).
  * `title` — строка, название квеста.
  * `difficulty` — строковый выбор (easy, normal, hard, nightmare).
  * `description` — текст, условия и лор.
  * `reward_gold` — целое неотрицательное, награда в золоте.

* **Player.quests** — `ManyToManyField` к `Quest` (без `through`).
  Игрок может участвовать в нескольких квестах, квест может иметь многих участников.

**Что демонстрирует:** многие-ко-многим на чистом `ManyToManyField`, без дополнительных полей.

---

### 4) Дополнительно (необязательно, но полезно для наглядности)

* **Region** — регион мира.
  Атрибуты: `name` (уникальная строка), `description` (текст).
* **Quest.region** — FK на `Region` (ещё один пример One-to-Many: «один регион → много квестов»).
  Можно добавить, если хочешь показать вторую связь один-ко-многим на другой паре сущностей.

---

## Требования к шаблонам и страницам (статические URL)

Подготовить минимум 4 страницы. Все URL **строго статические**, без параметров. На каждой странице выводить списки объектов и их связи.

1. **Страница игроков**
   URL: `/ui/players/`
   Содержимое:

   * Список игроков: `username`, `level`, `gold`, дата создания.
   * Для каждого игрока: краткий блок его `PlayerProfile` (аватар, bio, preferred_role), если существует.
   * Для каждого игрока: его гильдия (если есть) и ссылка на страницу гильдий.
   * Для каждого игрока: список его квестов (названия) с ссылкой на страницу квестов.

2. **Страница гильдий**
   URL: `/ui/guilds/`
   Содержимое:

   * Список гильдий: `name`, `motto`, `founded_at`.
   * Для каждой гильдии: количество участников и вложенный список участников (`members`), с их `username` и `level`.
   * Можно добавить агрегаты: средний уровень участников гильдии.

3. **Страница квестов**
   URL: `/ui/quests/`
   Содержимое:

   * Список квестов: `code`, `title`, `difficulty`, `reward_gold`.
   * Для каждого квеста: вложенный список участников (игроков), участвующих в квесте.
   * Если используешь `Region`: показывай регион каждого квеста.

4. **Обзорная страница**
   URL: `/ui/overview/`
   Содержимое:

   * Сводные числа: количество игроков, гильдий, квестов, профилей.
   * Топ-5 гильдий по числу участников (название, счетчик, несколько имён участников).
   * Топ-5 квестов по числу участников.
   * Несколько «карточек» игроков, у каждого — 1) гильдия, 2) первые 3 квеста, 3) сжатая информация профиля.

**Технические требования к шаблонам**

* Использовать Django Templates (`{% for %}`, `{{ }}`) и статические ссылки между страницами (например, «к Гильдиям» → `/ui/guilds/`), никаких параметров в URL.
* На каждой странице обязательно демонстрировать **обратные стороны** связей:

  * Для One-to-One: из `Player` показать `PlayerProfile` и учитывать отсутствие профиля.
  * Для One-to-Many: у `Guild` показать список `members` (обратная коллекция).
  * Для Many-to-Many: у `Quest` показать участников, у `Player` — его квесты.

---

## Вьюхи и маршруты (каркас)

* Реализовать 4 обработчика для статических страниц:

  * `/ui/players/`
  * `/ui/guilds/`
  * `/ui/quests/`
  * `/ui/overview/`

---

## Демоданные

* Подготовить management-команду `seed_demo`, которая создаёт:

  * 3–4 гильдии.
  * 20–30 игроков с распределением по гильдиям и разными уровнями/золотом.
  * Профили для большинства игроков (но не для всех, чтобы показать отсутствие профиля).
  * 12–16 квестов разных уровней сложности.
  * Many-to-Many связи: 2–5 квестов на игрока, 3–12 участников на квест.
  * (Опционально) 3–4 региона и привязку квестов к регионам.

---

## Критерии приёмки

1. Все связи корректно настроены: One-to-One (Player↔PlayerProfile), One-to-Many (Guild→Player), Many-to-Many (Player↔Quest на `ManyToManyField` без `through`).
2. Все 4 страницы доступны по статическим URL и наглядно показывают связи, включая обратные стороны.
3. На страницах списков и обзора задействованы `select_related`/`prefetch_related` для снижения числа запросов.
4. Админка позволяет быстро просматривать сущности и базовые атрибуты.
5. Команда `seed_demo` наполняет БД, после чего страницы отображают осмысленные списки и связи.

---
